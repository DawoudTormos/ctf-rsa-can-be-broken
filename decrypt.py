from Crypto.Util.number import long_to_bytes, inverse



e = 65537

N = [int(21116265552314960611778992936800873056610125486605469024379363165811280449264412855340474714511119934705610625901943863590781049756252581261969544872491782),
int(18764985757268206987038250232541972992568199723799716721612738866681247778431155426388117170604320971345416196764683417782315218792036850366158995950543478),
int(26451556837556052735933265855394925897381743538342496638000201809409082987761137087055829044372856221131836342659535643825788676756894013482131824984552086),
int(19407625070992492845029991036798862570057493998500944732076633947006273975958317240850396612899614594972882372056927842129312105989371833251520545356884914)
]

ciphertext = [int(
    1969198461359106064311004593933382746884821402010107961748171106899630834634337249630681639056981473557776555696939941295169716770162324721982792052645799
),
int(7881780350112622000220017997386193996068197021599369377189456987416010546569616597011059910993454392397366971763488277775905381538387504999562244969092125),
int(24142107911117476096529819914317970272331010897944534367954655287344529066471672846211991015902191285070083740837635227038533447816453487482188557830358039),
int(7969001109826828078425040542702035678713603217305348293685411314617487856340484988884774590832715143205883215813467788517545007480980221971430194392686347)]
def getPrivateKey(N,e):

    p=int(2)
    q = int(N // 2)
    privateKey = inverse(e, (p-1)*(q-1)) 

    print("N: ", N)
    print("\n-\n")
    print("e: ", e)
    print("\n-\n")
    print("p: ", p)
    print("\n-\n")
    print("q: ", q)
    print("\n-\n")
    print("private Key: ", privateKey)
    print("\n-\n")


    return privateKey






def decrypt(privkey, pubkey, ciphertext):
    """
    Decrypts the ciphertext using RSA private key
    """
    N= pubkey
    d = privkey
    m = pow(ciphertext, d, N)
    print("ciphertext: ", ciphertext)
    print("\n-\n")

    return long_to_bytes(m).decode('utf-8', errors='replace')


for i in range(len(N)):
    privateKey = getPrivateKey(N[i],e)
    message = decrypt(privateKey, N[i], ciphertext[i])
    
    print(message)
    print("\n\n-------------------------------------\n\n")


'''
N = int(16744915788667092967178197983098057211599941609687698847015673154237082700687465975543191832287238242607944724108269396021538739867102490527127081815434278)

d = int(6914300908113196238938195171197945415499600186487146315997579036065282774435730102995333948137154281289560610157571572003281848113011659162274153223498902)

ciphertext = int(
    3004491454717160770083143802707697548670123162720480743250014956482680125701145088135230228379229683613850710082193652367135370980908289994958293555818803
)


'''